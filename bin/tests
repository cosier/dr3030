#!/bin/bash

DIR="$( cd  "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
ROOT=$( cd $DIR/../ && pwd )

if [[ "$1" == "clean" ]]; then
  rm -rf $ROOT/build
  shift;
fi

mkdir -p $ROOT/build && cd $ROOT/build;
clear

$ROOT/bin/build

if [ ! $? -eq 0 ]; then
  exit 1
fi

make test
test_failed=$?

if [[ "$1" != "" ]]; then
  if [[ $test_error != 0 ]]; then
    clear
  fi
  echo "Running test: $1"
  echo
  $ROOT/build/tests/$1
fi

